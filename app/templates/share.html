{% extends "base.html" %}
{% block title %}Share Savings Goals{% endblock %}
{% block page_title %}Share Savings Goals{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <div class="dashboard-container bg-dark p-4 rounded">
        <div class="row">
          <!-- Share Form Section -->
          <div class="col-md-6">
            <div class="share-section bg-light p-4 rounded">
              <div class="share-header text-center mb-4">
                <h2>Share Your Savings Goals</h2>
              </div>
              
              <form id="share-form">
                <div class="mb-3">
                  <label for="username" class="form-label">Username to share with:</label>
                  <input type="text" class="form-control" id="username" name="username" required
                    placeholder="Enter username">
                </div>
                <div class="mb-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="share_goals" name="share_goals" checked>
                    <label class="form-check-label" for="share_goals">
                      Share Saving Goals
                    </label>
                  </div>
                </div>
                <div class="mb-3">
                  <p>Select specific goals to share:</p>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="share_goal1" name="share_goal1" 
                      {% if goal_id == '1' or not goal_id %}checked{% endif %}>
                    <label class="form-check-label" for="share_goal1">
                      Goal 1
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="share_goal2" name="share_goal2"
                      {% if goal_id == '2' %}checked{% endif %}>
                    <label class="form-check-label" for="share_goal2">
                      Goal 2
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="share_goal3" name="share_goal3"
                      {% if goal_id == '3' %}checked{% endif %}>
                    <label class="form-check-label" for="share_goal3">
                      Goal 3
                    </label>
                  </div>
                </div>
                <div class="mb-3">
                  <label for="message" class="form-label">Message (optional):</label>
                  <textarea class="form-control" id="message" name="message" rows="3" 
                    placeholder="Add a message about your goals"></textarea>
                </div>
                <div class="d-grid">
                  <button type="submit" class="btn btn-primary">Share Now</button>
                </div>
              </form>
            </div>
          </div>
          
          <div class="col-md-6">
            <div class="shares-section bg-light p-4 rounded">
              <div class="shares-header text-center mb-4">
                <h2>Received Shares</h2>
              </div>
              <div id="shared-goals-alerts" class="mt-3">
                <div class="text-center py-3">
                  <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading shared goals...</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal for Viewing Shared Goal -->
<div class="modal fade" id="viewSharedGoalModal" tabindex="-1" aria-labelledby="viewSharedGoalModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="viewSharedGoalModalLabel">Shared Goal Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div id="shared-goal-content">
          <div class="mb-4">
            <h4>Shared by: <span id="shared-by-username"></span></h4>
            <p class="text-muted">Shared on: <span id="shared-date"></span></p>
          </div>
          
          <div id="shared-message-container" class="alert alert-secondary mb-4">
            <h5>Message:</h5>
            <p id="shared-message"></p>
          </div>
          
          <div id="shared-goals-container">
            <!-- Goals will be populated here -->
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Make sure to include Bootstrap JS for the modal -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>

<!-- Include the separated JavaScript file -->
<script src="{{ url_for('static', filename='js/share.js') }}"></script>
<link href="{{ url_for('static', filename='css/share.css') }}" rel="stylesheet">
{% endblock %}